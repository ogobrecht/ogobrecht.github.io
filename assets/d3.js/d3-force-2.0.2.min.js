function netGobrechtsD3Force(a,b,c,d){"use strict";function e(){}var f={conf:{},confDefaults:{},data:{},dom:{},events:{},lib:{},main:{},status:{},tools:{},version:"2.0.2"};return f.main.init=function(){f.dom.containerId=a||"D3Force"+Math.floor(1e6*Math.random()),f.confUser=b||{},f.status.apexPluginId=c,f.status.apexPageItemsToSubmit=d,f.main.setupConfiguration(),f.main.setupDom(),f.main.setupFunctionReferences()},f.main.setupConfiguration=function(){f.conf.debug=f.status.apexPluginId&&1===apex.jQuery("#pdebug").length,f.status.debugPrefix="D3 Force in DOM container #"+f.dom.containerId+": ",f.status.customize=!1,f.status.customizeCurrentMenu="nodes",f.status.customizeCurrentTabPosition=null,f.status.forceTickCounter=0,f.status.forceStartTime=0,f.status.forceRunning=!1,f.status.graphStarted=!1,f.status.graphRendering=!1,f.status.graphReady=!1,f.status.graphOldPositions=null,f.status.sampleData=!1,f.confDefaults.minNodeRadius={display:!0,relation:"node",type:"number",val:6,options:[12,11,10,9,8,7,6,5,4,3,2,1]},f.confDefaults.maxNodeRadius={display:!0,relation:"node",type:"number",val:18,options:[36,34,32,30,28,26,24,22,20,18,16,14,12]},f.confDefaults.colorScheme={display:!0,relation:"node",type:"text",val:"color20",options:["color20","color20b","color20c","color10","direct"]},f.confDefaults.dragMode={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.pinMode={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.nodeEventToStopPinMode={display:!0,relation:"node",type:"text",val:"contextmenu",options:["none","dblclick","contextmenu"]},f.confDefaults.onNodeContextmenuPreventDefault={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.nodeEventToOpenLink={display:!0,relation:"node",type:"text",val:"dblclick",options:["none","click","dblclick","contextmenu"]},f.confDefaults.nodeLinkTarget={display:!0,relation:"node",type:"text",val:"_blank",options:["none","_blank","nodeID","domContainerID"]},f.confDefaults.showLabels={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.labelsCircular={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.labelDistance={display:!0,relation:"node",type:"number",val:12,options:[30,28,26,24,22,20,18,16,14,12,10,8,6,4,2]},f.confDefaults.preventLabelOverlappingOnForceEnd={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.labelPlacementIterations={display:!0,relation:"node",type:"number",val:250,options:[2e3,1e3,500,250,125]},f.confDefaults.showTooltips={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.tooltipPosition={display:!0,relation:"node",type:"text",val:"svgTopRight",options:["node","svgTopLeft","svgTopRight"]},f.confDefaults.alignFixedNodesToGrid={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.gridSize={display:!0,relation:"node",type:"number",val:50,options:[150,140,130,120,110,100,90,80,70,60,50,40,30,20,10]},f.confDefaults.linkDistance={display:!0,relation:"link",type:"number",val:80,options:[120,110,100,90,80,70,60,50,40,30,20]},f.confDefaults.showLinkDirection={display:!0,relation:"link",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.showSelfLinks={display:!0,relation:"link",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.selfLinkDistance={display:!0,relation:"link",type:"number",val:20,options:[30,28,26,24,22,20,18,16,14,12,10,8]},f.confDefaults.useDomParentWidth={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.width={display:!0,relation:"graph",type:"number",val:500,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},f.confDefaults.height={display:!0,relation:"graph",type:"number",val:500,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},f.confDefaults.setDomParentPaddingToZero={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.showBorder={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.showLegend={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.showLoadingIndicatorOnAjaxCall={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},f.confDefaults.lassoMode={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.zoomMode={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.minZoomFactor={display:!0,relation:"graph",type:"number",val:.2,options:[1,.9,.8,.7,.6,.5,.4,.3,.2,.1]},f.confDefaults.maxZoomFactor={display:!0,relation:"graph",type:"number",val:5,options:[10,9,8,7,6,5,4,3,2,1]},f.confDefaults.transform={display:!1,relation:"graph",type:"object",val:{translate:[0,0],scale:1}},f.confDefaults.autoRefresh={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},f.confDefaults.refreshInterval={display:!0,relation:"graph",type:"number",val:5e3,options:[6e4,3e4,15e3,1e4,5e3,2500]},f.confDefaults.chargeDistance={display:!1,relation:"graph",type:"number",val:1/0,options:[1/0,25600,12800,6400,3200,1600,800,400,200,100],internal:!0},f.confDefaults.charge={display:!0,relation:"graph",type:"number",val:-350,options:[-1e3,-950,-900,-850,-800,-750,-700,-650,-600,-550,-500,-450,-400,-350,-300,-250,-200,-150,-100,-50,0],internal:!0},f.confDefaults.gravity={display:!0,relation:"graph",type:"number",val:.1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},f.confDefaults.linkStrength={display:!0,relation:"graph",type:"number",val:1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},f.confDefaults.friction={display:!0,relation:"graph",type:"number",val:.9,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},f.confDefaults.theta={display:!0,relation:"graph",type:"number",val:.8,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},f.conf.debug="undefined"!=typeof f.confUser.debug?f.tools.parseBool(f.confUser.debug):!1,f.conf.minNodeRadius=f.confUser.minNodeRadius||f.confDefaults.minNodeRadius.val,f.conf.maxNodeRadius=f.confUser.maxNodeRadius||f.confDefaults.maxNodeRadius.val,f.conf.colorScheme=f.confUser.colorScheme||f.confDefaults.colorScheme.val,f.conf.dragMode="undefined"!=typeof f.confUser.dragMode?f.tools.parseBool(f.confUser.dragMode):f.confDefaults.dragMode.val,f.conf.pinMode="undefined"!=typeof f.confUser.pinMode?f.tools.parseBool(f.confUser.pinMode):f.confDefaults.pinMode.val,f.conf.nodeEventToStopPinMode=f.confUser.nodeEventToStopPinMode||f.confDefaults.nodeEventToStopPinMode.val,f.conf.onNodeContextmenuPreventDefault="undefined"!=typeof f.confUser.onNodeContextmenuPreventDefault?f.tools.parseBool(f.confUser.onNodeContextmenuPreventDefault):f.confDefaults.onNodeContextmenuPreventDefault.val,f.conf.nodeEventToOpenLink=f.confUser.nodeEventToOpenLink||f.confDefaults.nodeEventToOpenLink.val,f.conf.nodeLinkTarget=f.confUser.nodeLinkTarget||f.confDefaults.nodeLinkTarget.val,f.conf.showLabels="undefined"!=typeof f.confUser.showLabels?f.tools.parseBool(f.confUser.showLabels):f.confDefaults.showLabels.val,f.conf.labelsCircular="undefined"!=typeof f.confUser.labelsCircular?f.tools.parseBool(f.confUser.labelsCircular):f.confDefaults.labelsCircular.val,f.conf.labelDistance=f.confUser.labelDistance||f.confDefaults.labelDistance.val,f.conf.preventLabelOverlappingOnForceEnd="undefined"!=typeof f.confUser.preventLabelOverlappingOnForceEnd?f.tools.parseBool(f.confUser.preventLabelOverlappingOnForceEnd):f.confDefaults.preventLabelOverlappingOnForceEnd.val,f.conf.labelPlacementIterations=f.confUser.labelPlacementIterations||f.confDefaults.labelPlacementIterations.val,f.conf.showTooltips="undefined"!=typeof f.confUser.showTooltips?f.tools.parseBool(f.confUser.showTooltips):f.confDefaults.showTooltips.val,f.conf.tooltipPosition=f.confUser.tooltipPosition||f.confDefaults.tooltipPosition.val,f.conf.alignFixedNodesToGrid="undefined"!=typeof f.confUser.alignFixedNodesToGrid?f.tools.parseBool(f.confUser.alignFixedNodesToGrid):f.confDefaults.alignFixedNodesToGrid.val,f.conf.gridSize=f.confUser.gridSize&&f.confUser.gridSize>0?f.confUser.gridSize:f.confDefaults.gridSize.val,f.conf.linkDistance=f.confUser.linkDistance||f.confDefaults.linkDistance.val,f.conf.showLinkDirection="undefined"!=typeof f.confUser.showLinkDirection?f.tools.parseBool(f.confUser.showLinkDirection):f.confDefaults.showLinkDirection.val,f.conf.showSelfLinks="undefined"!=typeof f.confUser.showSelfLinks?f.tools.parseBool(f.confUser.showSelfLinks):f.confDefaults.showSelfLinks.val,f.conf.selfLinkDistance=f.confUser.selfLinkDistance||f.confDefaults.selfLinkDistance.val,f.conf.useDomParentWidth="undefined"!=typeof f.confUser.useDomParentWidth?f.tools.parseBool(f.confUser.useDomParentWidth):f.confDefaults.useDomParentWidth.val,f.conf.width=f.confUser.width||f.confDefaults.width.val,f.conf.height=f.confUser.height||f.confDefaults.height.val,f.conf.setDomParentPaddingToZero="undefined"!=typeof f.confUser.setDomParentPaddingToZero?f.tools.parseBool(f.confUser.setDomParentPaddingToZero):f.confDefaults.setDomParentPaddingToZero.val,f.conf.showBorder="undefined"!=typeof f.confUser.showBorder?f.tools.parseBool(f.confUser.showBorder):f.confDefaults.showBorder.val,f.conf.showLegend="undefined"!=typeof f.confUser.showLegend?f.tools.parseBool(f.confUser.showLegend):f.confDefaults.showLegend.val,f.conf.showLoadingIndicatorOnAjaxCall="undefined"!=typeof f.confUser.showLoadingIndicatorOnAjaxCall?f.tools.parseBool(f.confUser.showLoadingIndicatorOnAjaxCall):f.confDefaults.showLoadingIndicatorOnAjaxCall.val,f.conf.lassoMode="undefined"!=typeof f.confUser.lassoMode?f.tools.parseBool(f.confUser.lassoMode):f.confDefaults.lassoMode.val,f.conf.zoomMode="undefined"!=typeof f.confUser.zoomMode?f.tools.parseBool(f.confUser.zoomMode):f.confDefaults.zoomMode.val,f.conf.minZoomFactor=f.confUser.minZoomFactor||f.confDefaults.minZoomFactor.val,f.conf.maxZoomFactor=f.confUser.maxZoomFactor||f.confDefaults.maxZoomFactor.val,f.conf.transform=f.confUser.transform||f.confDefaults.transform.val,f.conf.autoRefresh="undefined"!=typeof f.confUser.autoRefresh?f.tools.parseBool(f.confUser.autoRefresh):f.confDefaults.autoRefresh.val,f.conf.refreshInterval=f.confUser.refreshInterval||f.confDefaults.refreshInterval.val,f.conf.chargeDistance=f.confUser.chargeDistance||1/0,f.conf.charge=f.confUser.charge||f.confDefaults.charge.val,f.conf.gravity=f.confUser.gravity||f.confDefaults.gravity.val,f.conf.linkStrength=f.confUser.linkStrength||f.confDefaults.linkStrength.val,f.conf.friction=f.confUser.friction||f.confDefaults.friction.val,f.conf.theta=f.confUser.theta||f.confDefaults.theta.val,f.conf.onNodeMouseenterFunction=f.confUser.onNodeMouseenterFunction||null,f.conf.onNodeMouseleaveFunction=f.confUser.onNodeMouseleaveFunction||null,f.conf.onNodeClickFunction=f.confUser.onNodeClickFunction||null,f.conf.onNodeDblclickFunction=f.confUser.onNodeDblclickFunction||null,f.conf.onNodeContextmenuFunction=f.confUser.onNodeContextmenuFunction||null,f.conf.onLinkClickFunction=f.confUser.onLinkClickFunction||null,f.conf.onLassoStartFunction=f.confUser.onLassoStartFunction||null,f.conf.onLassoEndFunction=f.confUser.onLassoEndFunction||null,f.data.sampleData='<data><nodes ID="7839" LABEL="KING is THE KING, you know?" LABELCIRCULAR="true" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="5000" LINK="http://apex.oracle.com/" INFOSTRING="This visualization is based on the well known emp table." /><nodes ID="7698" LABEL="BLAKE" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="2850" /><nodes ID="7782" LABEL="CLARK" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="2450" /><nodes ID="7566" LABEL="JONES" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="2975" /><nodes ID="7788" LABEL="SCOTT" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="3000" /><nodes ID="7902" LABEL="FORD" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="3000" /><nodes ID="7369" LABEL="SMITH" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="800" /><nodes ID="7499" LABEL="ALLEN" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1600" /><nodes ID="7521" LABEL="WARD" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1250" /><nodes ID="7654" LABEL="MARTIN" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1250" /><nodes ID="7844" LABEL="TURNER" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1500" /><nodes ID="7876" LABEL="ADAMS" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="1100" /><nodes ID="7900" LABEL="JAMES" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="950" /><nodes ID="7934" LABEL="MILLER" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="1300" /><nodes ID="8888" LABEL="Who am I?" COLORVALUE="green" COLORLABEL="unspecified" SIZEVALUE="2000" LINK="https://github.com/ogobrecht/d3-force-apex-plugin/wiki/API-Reference#nodelinktarget" INFOSTRING="This is a good question. Think about it." /><nodes ID="9999" LABEL="Where I am?" COLORVALUE="#f00" COLORLABEL="unspecified" SIZEVALUE="1000" LINK="https://github.com/ogobrecht/d3-force-apex-plugin/wiki/API-Reference#nodelinktarget" INFOSTRING="This is a good question. What do you think?" /><links FROMID="7839" TOID="7839" STYLE="dotted" COLOR="blue" INFOSTRING="This is a self link (same source and target node) rendered along a path with the STYLE attribute set to dotted and COLOR attribute set to blue." /><links FROMID="7698" TOID="7839" STYLE="dashed" /><links FROMID="7782" TOID="7839" STYLE="dashed" COLOR="red" INFOSTRING="This is a link with the STYLE attribute set to dashed and COLOR attribute set to red." /><links FROMID="7566" TOID="7839" STYLE="dashed" /><links FROMID="7788" TOID="7566" STYLE="solid" /><links FROMID="7902" TOID="7566" STYLE="solid" /><links FROMID="7369" TOID="7902" STYLE="solid" /><links FROMID="7499" TOID="7698" STYLE="solid" /><links FROMID="7521" TOID="7698" STYLE="solid" /><links FROMID="7654" TOID="7698" STYLE="solid" /><links FROMID="7844" TOID="7698" STYLE="solid" /><links FROMID="7876" TOID="7788" STYLE="solid" /><links FROMID="7900" TOID="7698" STYLE="solid" /><links FROMID="7934" TOID="7782" STYLE="solid" /></data>',f.status.userAgent=navigator.userAgent,f.status.userAgentIe9To11=!1,(-1!==navigator.appVersion.indexOf("MSIE 9")||-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==f.status.userAgent.indexOf("Trident")&&-1!==f.status.userAgent.indexOf("rv:11"))&&(f.status.userAgentIe9To11=!0,f.tools.logError("Houston, we have a problem - user agent is IE 9, 10 or 11 - we have to provide a fix for markers: http://stackoverflow.com/questions/15588478/internet-explorer-10-not-showing-svg-path-d3-js-graph"))},f.main.setupDom=function(){f.dom.body=d3.select("body"),null===document.querySelector("#"+f.dom.containerId)?f.dom.container=f.dom.body.append("div").attr("id",f.dom.containerId):(f.dom.container=d3.select("#"+f.dom.containerId),d3.selectAll("#"+f.dom.containerId+"_tooltip, #"+f.dom.containerId+"_customizing").remove()),null===document.querySelector("#"+f.dom.containerId+" svg")?f.dom.svg=f.dom.container.append("svg"):(f.dom.svg=d3.select("#"+f.dom.containerId+" svg"),d3.selectAll("#"+f.dom.containerId+" svg *").remove()),f.dom.svgParent=d3.select(f.dom.svg.node().parentNode),f.conf.setDomParentPaddingToZero&&f.dom.svgParent.style("padding","0"),f.dom.svg.attr("class","net_gobrechts_d3_force").classed("border",f.conf.showBorder).attr("width",f.conf.width).attr("height",f.conf.height),f.dom.containerWidth=f.tools.getSvgParentInnerWidth(),f.conf.useDomParentWidth&&f.dom.svg.attr("width",f.dom.containerWidth),f.dom.defs=f.dom.svg.append("defs"),f.dom.graphOverlay=f.dom.svg.append("g").attr("class","graphOverlay"),f.dom.graphOverlaySizeHelper=f.dom.graphOverlay.append("rect").attr("class","graphOverlaySizeHelper"),f.dom.graph=f.dom.graphOverlay.append("g").attr("class","graph"),f.dom.legend=f.dom.svg.append("g").attr("class","legend"),f.dom.loading=f.dom.svg.append("svg:g").attr("class","loading").style("display","none"),f.dom.loadingRect=f.dom.loading.append("svg:rect").attr("width",f.tools.getGraphWidth()).attr("height",f.conf.height),f.dom.loadingText=f.dom.loading.append("svg:text").attr("x",f.tools.getGraphWidth()/2).attr("y",f.conf.height/2).text("Loading..."),f.dom.defs.append("svg:marker").attr("id",f.dom.containerId+"_highlighted").attr("class","highlighted").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),f.dom.defs.append("svg:marker").attr("id",f.dom.containerId+"_normal").attr("class","normal").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),null===document.querySelector("#"+f.dom.containerId+"_tooltip")?f.dom.tooltip=f.dom.body.append("div").attr("id",f.dom.containerId+"_tooltip").attr("class","net_gobrechts_d3_force_tooltip").style("top","0px").style("left","0px"):f.dom.tooltip=d3.select("#"+f.dom.containerId+"_tooltip")},f.main.setupFunctionReferences=function(){f.main.force=d3.layout.force().on("start",function(){f.tools.log("Force started."),f.status.customize&&f.dom.customizePositions&&f.dom.customizePositions.text("Force started - wait for end event to show positions..."),f.status.forceTickCounter=0,f.status.forceStartTime=(new Date).getTime(),f.status.forceRunning=!0}).on("tick",function(){f.status.userAgentIe9To11&&f.conf.showLinkDirection&&(f.main.links.each(function(){this.parentNode.insertBefore(this,this)}),f.main.selfLinks.each(function(){this.parentNode.insertBefore(this,this)})),f.main.selfLinks.attr("transform",function(a){return"translate("+a.source.x+","+a.source.y+")"}),f.main.links.attr("x1",function(a){return f.tools.adjustSourceX(a)}).attr("y1",function(a){return f.tools.adjustSourceY(a)}).attr("x2",function(a){return f.tools.adjustTargetX(a)}).attr("y2",function(a){return f.tools.adjustTargetY(a)}),f.conf.showLabels&&(f.main.labels.attr("x",function(a){return a.x}).attr("y",function(a){return a.y-a.radius-f.conf.labelDistance}),f.main.labelPaths.attr("transform",function(a){return"translate("+a.x+","+a.y+")"})),f.main.nodes.attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),f.status.forceTickCounter+=1}).on("end",function(){f.conf.showLabels&&f.conf.preventLabelOverlappingOnForceEnd&&(f.data.simulatedAnnealingLabels=[],f.data.simulatedAnnealingAnchors=[],f.main.labels.each(function(a,b){f.data.simulatedAnnealingLabels[b]={width:this.getBBox().width,height:this.getBBox().height,x:a.x,y:a.y-a.radius-f.conf.labelDistance}}),f.main.nodes.filter(function(a){return!a.LABELCIRCULAR&&!f.conf.labelsCircular}).each(function(a,b){f.data.simulatedAnnealingAnchors[b]={x:a.x,y:a.y-a.radius-f.conf.labelDistance,r:.5}}),f.lib.labelerPlugin().label(f.data.simulatedAnnealingLabels).anchor(f.data.simulatedAnnealingAnchors).width(f.tools.getGraphWidth()).height(f.conf.height).start(f.conf.labelPlacementIterations),f.main.labels.each(function(a,b){d3.select(this).transition().duration(800).attr("x",f.data.simulatedAnnealingLabels[b].x).attr("y",f.data.simulatedAnnealingLabels[b].y)})),f.status.forceRunning=!1;var a=(new Date).getTime()-f.status.forceStartTime,b=(a/1e3).toFixed(1),c=Math.round(f.status.forceTickCounter/(a/1e3)),d=Math.round(a/f.status.forceTickCounter);f.status.customize&&f.dom.customizePositions&&f.dom.customizePositions.text(JSON.stringify(e.positions())),f.tools.log("Force ended."),f.tools.log(b+" seconds, "+f.status.forceTickCounter+" ticks to cool down ("+c+" ticks/s, "+d+" ms/tick).")}),f.main.drag=f.main.force.drag(),f.main.lasso=f.lib.lassoPlugin().closePathDistance(100).closePathSelect(!0).hoverSelect(!0).area(f.dom.graphOverlay).pathContainer(f.dom.svg),f.main.zoom=d3.behavior.zoom()},f.tools.parseBool=function(a){switch(String(a).trim().toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"":return!1;default:return!1}},f.tools.parseXml=function(a){var b=null;if(a)if(window.DOMParser)try{b=(new DOMParser).parseFromString(a,"text/xml")}catch(c){b=null,f.tools.logError("DOMParser - unable to parse XML: "+c.message)}else if(window.ActiveXObject)try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)||f.tools.logError("Microsoft.XMLDOM - unable to parse XML: "+b.parseError.reason+b.parseError.srcText)}catch(c){b=null,f.tools.logError("Microsoft.XMLDOM - unable to parse XML: "+c.message)}return b},f.tools.xmlToJson=function(a){var b,c,d,e,f,g=null,h=function(a){if(b={},a.attributes.length>0)for(var c=0;c<a.attributes.length;c++)f=a.attributes.item(c),b[f.nodeName]=f.nodeValue;if(a.hasChildNodes())for(var e=0;e<a.childNodes.length;e++)d=a.childNodes.item(e),d.hasChildNodes()?b[d.nodeName]=d.childNodes.item(0).nodeValue:b[d.nodeName]="";return b};if(a&&(g={},g.data={},g.data.nodes=[],g.data.links=[],a.childNodes.item(0).hasChildNodes()))for(var i=0;i<a.childNodes.item(0).childNodes.length;i++)b=null,c=a.childNodes.item(0).childNodes.item(i),e=c.nodeName,"nodes"===e||"node"===e?g.data.nodes.push(h(c)):("links"===e||"link"===e)&&g.data.links.push(h(c));return g},f.tools.getSvgParentInnerWidth=function(){return parseInt(f.dom.svgParent.style("width"))-parseInt(f.dom.svgParent.style("padding-left"))-parseInt(f.dom.svgParent.style("padding-right"))-2*(f.dom.svg.style("border-width")?parseInt(f.dom.svg.style("border-width")):1)},f.tools.getGraphWidth=function(){return f.conf.useDomParentWidth?f.dom.containerWidth:f.conf.width},f.tools.log=function(a,b){f.conf.debug&&(b?console.log(a):console.log(f.status.debugPrefix+a)),f.status.customize&&f.dom.customizeLog&&f.dom.customizeLog.text(a+"\n"+f.dom.customizeLog.text())},f.tools.logError=function(a){console.log(f.status.debugPrefix+"ERROR: "+a),f.status.customize&&f.dom.customizeLog&&f.dom.customizeLog.text("ERROR: "+a+"\n"+f.dom.customizeLog.text())},f.tools.triggerApexEvent=function(a,b,c){f.status.apexPluginId&&apex.event.trigger(a,b,c)},f.tools.setRadiusFunction=function(){f.tools.radius=d3.scale.sqrt().range([f.conf.minNodeRadius,f.conf.maxNodeRadius]).domain(d3.extent(f.data.nodes,function(a){return parseFloat(a.SIZEVALUE)}))},f.tools.setColorFunction=function(){"color20"===f.conf.colorScheme?f.tools.color=d3.scale.category20():"color20b"===f.conf.colorScheme?f.tools.color=d3.scale.category20b():"color20c"===f.conf.colorScheme?f.tools.color=d3.scale.category20c():"color10"===f.conf.colorScheme?f.tools.color=d3.scale.category10():"direct"===f.conf.colorScheme?f.tools.color=function(a){return a}:(f.conf.colorScheme="color20",f.tools.color=d3.scale.category20())},f.tools.neighboring=function(a,b){return f.data.neighbors.indexOf(a.ID+":"+b.ID)>-1||f.data.neighbors.indexOf(b.ID+":"+a.ID)>-1},f.tools.getNearestGridPosition=function(a,b){var c,d;return f.conf.zoomMode?(c=a%f.conf.gridSize,d=c>f.conf.gridSize/2?a-c+f.conf.gridSize:a-c):a>=b?(c=b%f.conf.gridSize,d=b-c,d===b&&(d-=f.conf.gridSize)):a<=f.conf.gridSize/2?d=f.conf.gridSize:(c=a%f.conf.gridSize,d=c>f.conf.gridSize/2?a-c+f.conf.gridSize:a-c,d>=b&&(d-=f.conf.gridSize)),d},f.tools.adjustSourceX=function(a){return a.source.x+Math.cos(f.tools.calcAngle(a))*a.source.radius},f.tools.adjustSourceY=function(a){return a.source.y+Math.sin(f.tools.calcAngle(a))*a.source.radius},f.tools.adjustTargetX=function(a){return a.target.x-Math.cos(f.tools.calcAngle(a))*a.target.radius},f.tools.adjustTargetY=function(a){return a.target.y-Math.sin(f.tools.calcAngle(a))*a.target.radius},f.tools.calcAngle=function(a){return Math.atan2(a.target.y-a.source.y,a.target.x-a.source.x)},f.tools.getSelfLinkPath=function(a){var b=a.source.radius,c=a.source.radius+f.conf.selfLinkDistance,d=0,e=0,g={source:{x:0,y:0,radius:b},target:{x:d+c/2,y:e+c,radius:b}},h={source:{x:d-c/2,y:e+c,radius:b},target:{x:d,y:e,radius:b}},i="M"+f.tools.adjustSourceX(g)+","+f.tools.adjustSourceY(g);return i+=" L"+(d+c/2)+","+(e+c),i+=" A"+c+","+c+" 0 0,1 "+(d-c/2)+","+(e+c),i+=" L"+f.tools.adjustTargetX(h)+","+f.tools.adjustTargetY(h)},f.tools.getLabelPath=function(a){var b=a.radius+f.conf.labelDistance,c=0,d=0,e="M"+(c-b)+","+d;return e+=" a"+b+","+b+" 0 0,1 "+2*b+",0",e+=" a"+b+","+b+" 0 0,1 -"+2*b+",0"},f.tools.openLink=function(a){var b;"none"===f.conf.nodeLinkTarget?window.location.assign(a.LINK):"nodeID"===f.conf.nodeLinkTarget?(b=window.open(a.LINK,a.ID),b.focus()):"domContainerID"===f.conf.nodeLinkTarget?(b=window.open(a.LINK,f.dom.containerId),b.focus()):(b=window.open(a.LINK,f.conf.nodeLinkTarget),b.focus())},f.tools.applyConfigurationObject=function(a){var b;for(b in a)a.hasOwnProperty(b)&&f.conf.hasOwnProperty(b)&&a[b]!==f.conf[b]&&e[b](a[b])},f.tools.zoomEventProxy=function(a){return function(){f.conf.dragMode&&(!f.conf.dragMode||"circle"===d3.event.target.tagName)||!f.conf.zoomMode||d3.event.altKey||d3.event.shiftKey||a.apply(this,arguments)}},f.tools.lassoEventProxy=function(a){return function(){f.conf.dragMode&&"circle"===d3.event.target.tagName||!f.conf.lassoMode||f.conf.zoomMode&&!d3.event.altKey&&!d3.event.shiftKey||a.apply(this,arguments)}},f.tools.showTooltip=function(a){var b;f.dom.tooltip.html(a).style("display","block"),"svgTopLeft"===f.conf.tooltipPosition?(b=f.tools.getOffsetRect(f.dom.svg.node()),f.dom.tooltip.style("top",b.top+(f.dom.svg.style("border-width")?parseInt(f.dom.svg.style("border-width")):1)+"px").style("left",b.left+(f.dom.svg.style("border-width")?parseInt(f.dom.svg.style("border-width")):1)+"px")):"svgTopRight"===f.conf.tooltipPosition?(b=f.tools.getOffsetRect(f.dom.svg.node()),f.dom.tooltip.style("top",b.top+parseInt(f.dom.svg.style("border-width")?parseInt(f.dom.svg.style("border-width")):1)+"px").style("left",b.left+parseInt(f.dom.svg.style("width"))+parseInt(f.dom.svg.style("border-width")?parseInt(f.dom.svg.style("border-width")):1)-parseInt(f.dom.tooltip.style("width"))-2*parseInt(f.dom.tooltip.style("border-width")?parseInt(f.dom.tooltip.style("border-width")):0)-parseInt(f.dom.tooltip.style("padding-left"))-parseInt(f.dom.tooltip.style("padding-right"))+"px")):f.dom.tooltip.style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY+"px")},f.tools.hideTooltip=function(){f.dom.tooltip.style("display","none")},f.tools.onLinkClick=function(a){return d3.event.defaultPrevented?null:(f.tools.log("Event link_click triggered."),f.tools.triggerApexEvent(this,"net_gobrechts_d3_force_linkclick",a),"function"==typeof f.conf.onLinkClickFunction&&f.conf.onLinkClickFunction.call(this,d3.event,a),void 0)},f.tools.getMarkerUrl=function(a){return f.conf.showLinkDirection?"url(#"+f.dom.containerId+"_"+(a.COLOR?a.COLOR:"normal")+")":null},f.tools.getMarkerUrlHighlighted=function(){return f.conf.showLinkDirection?"url(#"+f.dom.containerId+"_highlighted)":null},f.tools.onLinkMouseenter=function(a){f.conf.showTooltips&&a.INFOSTRING&&f.tools.showTooltip(a.INFOSTRING)},f.tools.onLinkMouseleave=function(){f.conf.showTooltips&&f.tools.hideTooltip()},f.tools.onNodeMouseenter=function(a){f.main.nodes.classed("highlighted",function(b){return f.tools.neighboring(b,a)}),f.main.links.classed("highlighted",function(b){return b.source.ID===a.ID||b.target.ID===a.ID}).style("marker-end",function(b){return b.source.ID===a.ID||b.target.ID===a.ID?f.tools.getMarkerUrlHighlighted(b):f.tools.getMarkerUrl(b)}),f.main.selfLinks.classed("highlighted",function(b){return b.FROMID===a.ID}).style("marker-end",function(b){return b.source.ID===a.ID||b.target.ID===a.ID?f.tools.getMarkerUrlHighlighted(b):f.tools.getMarkerUrl(b)}),f.conf.showLabels&&(f.main.labels.classed("highlighted",function(b){return b.ID===a.ID}),f.main.labelsCircular.classed("highlighted",function(b){return b.ID===a.ID})),d3.select(this).classed("highlighted",!0),f.tools.log("Event node_mouseenter triggered."),f.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseenter",a),"function"==typeof f.conf.onNodeMouseenterFunction&&f.conf.onNodeMouseenterFunction.call(this,d3.event,a),f.conf.showTooltips&&a.INFOSTRING&&f.tools.showTooltip(a.INFOSTRING)},f.tools.onNodeMouseleave=function(a){f.main.nodes.classed("highlighted",!1),f.main.links.classed("highlighted",!1).style("marker-end",f.tools.getMarkerUrl),f.main.selfLinks.classed("highlighted",!1).style("marker-end",f.tools.getMarkerUrl),f.conf.showLabels&&(f.main.labels.classed("highlighted",!1),f.main.labelsCircular.classed("highlighted",!1)),f.tools.log("Event node_mouseleave triggered."),f.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseleave",a),"function"==typeof f.conf.onNodeMouseleaveFunction&&f.conf.onNodeMouseleaveFunction.call(this,d3.event,a),f.conf.showTooltips&&f.tools.hideTooltip()},f.tools.onNodeClick=function(a){return d3.event.defaultPrevented?null:(a.LINK&&"click"===f.conf.nodeEventToOpenLink&&f.tools.openLink(a),"click"===f.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",a.fixed=0),f.tools.log("Event node_click triggered."),f.tools.triggerApexEvent(this,"net_gobrechts_d3_force_click",a),"function"==typeof f.conf.onNodeClickFunction&&f.conf.onNodeClickFunction.call(this,d3.event,a),void 0)},f.tools.onNodeDblclick=function(a){a.LINK&&"dblclick"===f.conf.nodeEventToOpenLink&&f.tools.openLink(a),"dblclick"===f.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",a.fixed=0),f.tools.log("Event node_dblclick triggered."),f.tools.triggerApexEvent(this,"net_gobrechts_d3_force_dblclick",a),"function"==typeof f.conf.onNodeDblclickFunction&&f.conf.onNodeDblclickFunction.call(this,d3.event,a)},f.tools.onNodeContextmenu=function(a){f.conf.onNodeContextmenuPreventDefault&&d3.event.preventDefault(),a.LINK&&"contextmenu"===f.conf.nodeEventToOpenLink&&f.tools.openLink(a),"contextmenu"===f.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",a.fixed=0),f.tools.log("Event node_contextmenu triggered."),f.tools.triggerApexEvent(this,"net_gobrechts_d3_force_contextmenu",a),"function"==typeof f.conf.onNodeContextmenuFunction&&f.conf.onNodeContextmenuFunction.call(this,d3.event,a)},f.tools.onLassoStart=function(a){var b={};b.numberOfSelectedNodes=0,b.idsOfSelectedNodes=null,b.numberOfNodes=a.size(),b.nodes=a,f.tools.log("Event lasso_start triggered."),f.tools.triggerApexEvent(document.querySelector("#"+f.dom.containerId),"net_gobrechts_d3_force_lassostart",b),"function"==typeof f.conf.onLassoStartFunction&&f.conf.onLassoStartFunction.call(f.dom.svg,d3.event,b)},f.tools.onLassoEnd=function(a){var b={};b.numberOfSelectedNodes=0,b.idsOfSelectedNodes="",b.numberOfNodes=a.size(),b.nodes=a,a.each(function(a){a.selected&&(b.idsOfSelectedNodes+=a.ID+":",b.numberOfSelectedNodes++)}),b.idsOfSelectedNodes=b.idsOfSelectedNodes.length>0?b.idsOfSelectedNodes.substr(0,b.idsOfSelectedNodes.length-1):null,f.tools.log("Event lasso_end triggered."),f.tools.triggerApexEvent(document.querySelector("#"+f.dom.containerId),"net_gobrechts_d3_force_lassoend",b),"function"==typeof f.conf.onLassoEndFunction&&f.conf.onLassoEndFunction.call(f.dom.svg,d3.event,b)},f.tools.getOffsetRect=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}},f.tools.createLegend=function(){f.data.distinctNodeColorValues.forEach(function(a,b){var c=a.split(";");f.dom.legend.append("circle").attr("cx",11).attr("cy",f.conf.height-(14*(b+1)-3)).attr("r",6).attr("fill",f.tools.color(c[1])),f.dom.legend.append("text").attr("x",21).attr("y",f.conf.height-(14*(b+1)-6)).text(c[0]?c[0]:c[1])})},f.tools.removeLegend=function(){f.dom.legend.selectAll("*").remove()},f.tools.writeConfObjectIntoWizard=function(){f.status.customize&&f.dom.customizeConfObject.text(JSON.stringify(e.optionsCustomizationWizard(),null,"  "))},f.tools.createCustomizeLink=function(){!f.status.customize&&(f.conf.debug||document.querySelector("#apex-dev-toolbar")||document.querySelector("#apexDevToolbar"))&&null===document.querySelector("#"+f.dom.containerId+" svg text.link")&&f.dom.svg.append("svg:text").attr("class","link").attr("x",5).attr("y",15).attr("text-anchor","start").text("Customize Me").on("click",function(){
e.customize(!0)})},f.tools.removeCustomizeLink=function(){f.dom.svg.select("#"+f.dom.containerId+" svg text.link").remove()},f.tools.customizeDrag=d3.behavior.drag().on("dragstart",function(){var a=d3.mouse(document.body);f.dom.customizePosition=f.tools.getOffsetRect(document.querySelector("#"+f.dom.containerId+"_customizing")),f.dom.customizePosition.mouseLeft=a[0]-f.dom.customizePosition.left,f.dom.customizePosition.mouseTop=a[1]-f.dom.customizePosition.top}).on("drag",function(){var a=d3.mouse(document.body);f.dom.customize.style("left",Math.max(0,a[0]-f.dom.customizePosition.mouseLeft)+"px").style("top",Math.max(0,a[1]-f.dom.customizePosition.mouseTop)+"px")}).on("dragend",function(){f.dom.customizePosition=f.tools.getOffsetRect(f.dom.customize.node())}),f.tools.createCustomizeWizardIfNotRendering=function(){f.status.customize&&!f.status.graphRendering&&f.tools.createCustomizeWizard()},f.tools.createCustomizeWizard=function(){var a,b,c,d,g,h,i,j,k,l=4,m=function(){e.releaseFixedNodes().resume()},n=function(){f.status.customizeCurrentTabPosition=this.id,"text"===f.confDefaults[this.name].type?e[this.name](this.options[this.selectedIndex].value).render():"number"===f.confDefaults[this.name].type?e[this.name](parseFloat(this.options[this.selectedIndex].value)).render():"bool"===f.confDefaults[this.name].type&&e[this.name]("true"===this.options[this.selectedIndex].value).render()},o=function(a){f.confDefaults[a].options.forEach(function(b){i=b,h.append("option").attr("value",b).attr("selected",function(){return"text"===f.confDefaults[a].type||"bool"===f.confDefaults[a].type?i===f.conf[a]?(j=!0,"selected"):null:"number"===f.confDefaults[a].type?parseFloat(i)===f.conf[a]?(j=!0,"selected"):null:void 0}).text(b)})};if(f.status.customize){f.tools.removeCustomizeLink(),f.dom.customizePosition||(f.dom.customizePosition=f.tools.getOffsetRect(f.dom.svg.node()),f.dom.customizePosition.left=f.dom.customizePosition.left+f.conf.width+8),null!==document.querySelector("#"+f.dom.containerId+"_customizing")&&f.dom.customize.remove(),f.dom.customize=f.dom.body.insert("div").attr("id",f.dom.containerId+"_customizing").attr("class","net_gobrechts_d3_force_customize").style("left",f.dom.customizePosition.left+"px").style("top",f.dom.customizePosition.top+"px"),f.dom.customize.append("span").attr("class","drag").call(f.tools.customizeDrag).append("span").attr("class","title").text('Customize "'+f.dom.containerId+'"'),f.dom.customize.append("a").attr("class","close focus").attr("tabindex",1).text("Close").on("click",function(){f.status.customize=!1,f.tools.removeCustomizeWizard(),f.tools.createCustomizeLink()}).on("keydown",function(){13===d3.event.keyCode&&(f.status.customize=!1,f.tools.removeCustomizeWizard(),f.tools.createCustomizeLink())}),a=f.dom.customize.append("table"),b=a.append("tr"),c=b.append("td").style("vertical-align","top"),f.dom.customizeMenu=c.append("span"),f.dom.customizeOptionsTable=c.append("table");for(k in f.confDefaults)f.confDefaults.hasOwnProperty(k)&&f.confDefaults[k].display&&(l+=1,d=f.dom.customizeOptionsTable.append("tr").attr("class",f.confDefaults[k].relation+"-related"),d.append("td").attr("class","label").html('<a href="https://gobrechts.net/wiki/projects/d3-force-apex-plugin#'+k.toLowerCase()+'" target="github_d3_force" tabindex="'+l+'100">'+k+"</a>"),g=d.append("td"),h=g.append("select").attr("id",f.dom.containerId+"_"+k).attr("name",k).attr("value",f.conf[k]).attr("tabindex",l+1).classed("warning",f.confDefaults[k].internal).on("change",n),j=!1,o(k),j||(h.append("option").attr("value",f.conf[k]).attr("selected","selected").text(f.conf[k]),f.confDefaults[k].options.push(f.conf[k])),"pinMode"===k&&g.append("a").text("release all").attr("href",null).on("click",m));f.dom.customizeOptionsTable.style("width",d3.select(f.dom.customizeOptionsTable).node()[0][0].clientWidth+"px"),c.append("span").html("<br>"),c=b.append("td").style("vertical-align","top").style("padding-left","5px"),c.append("span").html('Your Configuration Object<p style="font-size:10px;margin:0;">'+(f.status.apexPluginId?"To save your options please copy<br>this to your plugin region attributes.<br>Only non-default options are shown.</p>":"Use this to initialize your graph.<br>Only non-default options are shown.</p>")),f.dom.customizeConfObject=c.append("textarea").attr("tabindex",l+5).attr("readonly","readonly"),c.append("span").html("<br><br>Current Positions<br>"),f.dom.customizePositions=c.append("textarea").attr("tabindex",l+6).attr("readonly","readonly").text(f.status.forceRunning?"Force started - wait for end event to show positions...":JSON.stringify(e.positions())),c.append("span").html("<br><br>Debug Log (descending)<br>"),f.dom.customizeLog=c.append("textarea").attr("tabindex",l+7).attr("readonly","readonly"),b=a.append("tr"),c=b.append("td").attr("colspan",2).html("Copyrights:"),b=a.append("tr"),c=b.append("td").attr("colspan",2).html('<table><tr><td style="padding-right:20px;"><a href="https://github.com/ogobrecht/d3-force-apex-plugin" target="_blank" tabindex="'+(l+8)+'">D3 Force APEX Plugin</a> ('+f.version+')<br>Ottmar Gobrecht</td><td style="padding-right:20px;"><a href="https://github.com/mbostock/d3" target="d3js_org" tabindex="'+(l+9)+'">D3.js</a> ('+d3.version+') and <a href="https://github.com/d3/d3-plugins/tree/master/lasso" target="_blank" tabindex="'+(l+10)+'">D3 Lasso Plugin</a> (modified)<br>Mike Bostock</td></tr><tr><td colspan="3"><a href="https://github.com/tinker10/D3-Labeler" target="github_d3_labeler" tabindex="'+(l+11)+'">D3 Labeler Plugin</a> (automatic label placement using simulated annealing)<br>Evan Wang</td></tr></table>'),f.tools.createCustomizeMenu(f.status.customizeCurrentMenu),f.tools.writeConfObjectIntoWizard(),f.status.customizeCurrentTabPosition&&document.getElementById(f.status.customizeCurrentTabPosition).focus()}else f.tools.removeCustomizeWizard(),f.tools.createCustomizeLink()},f.tools.removeCustomizeWizard=function(){d3.select("#"+f.dom.containerId+"_customizing").remove()},f.tools.createCustomizeMenu=function(a){f.status.customizeCurrentMenu=a,f.dom.customizeMenu.selectAll("*").remove(),f.dom.customizeMenu.append("span").text("Show options for:"),"nodes"===f.status.customizeCurrentMenu?(f.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("NODES"),f.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0)):f.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("NODES").attr("tabindex",2).on("click",function(){f.tools.createCustomizeMenu("nodes"),f.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(f.tools.createCustomizeMenu("nodes"),f.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0))}),"links"===f.status.customizeCurrentMenu?(f.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("LINKS"),f.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0)):f.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("LINKS").attr("tabindex",3).on("click",function(){f.tools.createCustomizeMenu("links"),f.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(f.tools.createCustomizeMenu("links"),f.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0))}),"graph"===f.status.customizeCurrentMenu?(f.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("GRAPH"),f.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0)):f.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("GRAPH").attr("tabindex",4).on("click",function(){f.tools.createCustomizeMenu("graph"),f.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(f.tools.createCustomizeMenu("graph"),f.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),f.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0))}),f.dom.customizeMenu.append("span").html("<br><br>")},f.lib.labelerPlugin=function(){var a,b,c=[],d=[],e=1,f=1,g={},h=5,i=.5,j=0,k=0,l=.2,m=1,n=30,o=30,p=1,q=!1,r=!1,s=function(a){var b=c.length,e=0,f=c[a].x-d[a].x,g=d[a].y-c[a].y,h=Math.sqrt(f*f+g*g),i=!0;h>0&&(e+=h*l),f/=h,g/=h,e+=f>0&&g>0?0:0>f&&g>0?p:0>f&&0>g?2*p:3*p;for(var j,k,q,r,s,t,u,w=c[a].x,x=c[a].y-c[a].height+2,y=c[a].x+c[a].width,z=c[a].y+2,A=0;b>A;A++)A!==a&&(i=v(d[a].x,c[a].x,d[A].x,c[A].x,d[a].y,c[a].y,d[A].y,c[A].y),i&&(e+=m),j=c[A].x,q=c[A].y-c[A].height+2,k=c[A].x+c[A].width,r=c[A].y+2,s=Math.max(0,Math.min(k,y)-Math.max(j,w)),t=Math.max(0,Math.min(r,z)-Math.max(q,x)),u=s*t,e+=u*n),j=d[A].x-d[A].r,q=d[A].y-d[A].r,k=d[A].x+d[A].r,r=d[A].y+d[A].r,s=Math.max(0,Math.min(k,y)-Math.max(j,w)),t=Math.max(0,Math.min(r,z)-Math.max(q,x)),u=s*t,e+=u*o;return e},t=function(b){var g,i=Math.floor(Math.random()*c.length),l=c[i].x,m=c[i].y;g=q?a(i,c,d):s(i),c[i].x+=(Math.random()-.5)*h,c[i].y+=(Math.random()-.5)*h,c[i].x>e&&(c[i].x=l),c[i].x<0&&(c[i].x=l),c[i].y>f&&(c[i].y=m),c[i].y<0&&(c[i].y=m);var n;n=q?a(i,c,d):s(i);var o=n-g;Math.random()<Math.exp(-o/b)?j+=1:(c[i].x=l,c[i].y=m,k+=1)},u=function(b){var g,h=Math.floor(Math.random()*c.length),l=c[h].x,m=c[h].y;g=q?a(h,c,d):s(h);var n=(Math.random()-.5)*i,o=Math.sin(n),p=Math.cos(n);c[h].x-=d[h].x,c[h].y-=d[h].y;var r=c[h].x*p-c[h].y*o,t=c[h].x*o+c[h].y*p;c[h].x=r+d[h].x,c[h].y=t+d[h].y,c[h].x>e&&(c[h].x=l),c[h].x<0&&(c[h].x=l),c[h].y>f&&(c[h].y=m),c[h].y<0&&(c[h].y=m);var u;u=q?a(h,c,d):s(h);var v=u-g;Math.random()<Math.exp(-v/b)?j+=1:(c[h].x=l,c[h].y=m,k+=1)},v=function(a,b,c,d,e,f,g,h){var i,j,k,l,m;return k=(h-g)*(b-a)-(d-c)*(f-e),l=(d-c)*(e-g)-(h-g)*(a-c),m=(b-a)*(e-g)-(f-e)*(a-c),i=l/k,j=m/k,!(0>i||i>1||0>j||j>1)},w=function(a,b,c){return a-b/c};return g.start=function(a){for(var b=c.length,d=1,e=1,f=0;a>f;f++){for(var g=0;b>g;g++)Math.random()<.5?t(d):u(d);d=w(d,e,a)}},g.width=function(a){return arguments.length?(e=a,g):e},g.height=function(a){return arguments.length?(f=a,g):f},g.label=function(a){return arguments.length?(c=a,g):c},g.anchor=function(a){return arguments.length?(d=a,g):d},g.alt_energy=function(b){return arguments.length?(a=b,q=!0,g):s},g.alt_schedule=function(a){return arguments.length?(b=a,r=!0,g):w},g},f.lib.lassoPlugin=function(){function a(){function a(){q="",n.attr("d",null),o.attr("d",null),t=0,c[0].forEach(function(a){a.hoverSelected=!1,a.loopSelected=!1;var b=a.getBBox(),c=a.getCTM();a.lassoPoint={cx:Math.round((b.x+b.width/2)*c.a+c.e),cy:Math.round((b.y+b.height/2)*c.d+c.f),edges:{top:0,right:0,bottom:0,left:0},close_edges:{left:0,right:0}}}),g===!0&&c.on("mouseover.lasso",function(){d3.select(this)[0][0].hoverSelected=!0}),j.start()}function k(){var a,g,h,i,k,l,m,u,v,w,x,y,z,A,B=d3.mouse(this)[0],C=d3.mouse(this)[1],D=function(a){A.x>a.lassoPoint.cx&&(a.lassoPoint.edges.right=a.lassoPoint.edges.right+1),A.x<a.lassoPoint.cx&&(a.lassoPoint.edges.left=a.lassoPoint.edges.left+1)},E=function(a){Math.round(z.y)!==Math.round(x.y)&&Math.round(z.x)>a.lassoPoint.cx&&(a.lassoPoint.close_edges.right=1),Math.round(z.y)!==Math.round(x.y)&&Math.round(z.x)<a.lassoPoint.cx&&(a.lassoPoint.close_edges.left=1)},F=function(a){return a.lassoPoint.cy===Math.round(z.y)},G=function(a){var c;return a.lassoPoint.cy===A.y&&a.lassoPoint.cy!==y.y?(s={x:y.x,y:y.y},c=!1):a.lassoPoint.cy===A.y&&a.lassoPoint.cy===y.y?c=!1:a.lassoPoint.cy===y.y&&a.lassoPoint.cy!==A.y?c=b(a.lassoPoint.cy-A.y)!==b(a.lassoPoint.cy-s.y):(s={x:y.x,y:y.y},c=b(a.lassoPoint.cy-A.y)!==b(a.lassoPoint.cy-y.y)),c};for(""===q?(q=q+"M "+B+" "+C,r=[B,C]):q=q+" L "+B+" "+C,c[0].forEach(function(a){a.lassoPoint.close_edges={left:0,right:0}}),a=Math.sqrt(Math.pow(B-r[0],2)+Math.pow(C-r[1],2)),g="M "+B+" "+C+" L "+r[0]+" "+r[1],n.attr("d",q),d>=a?o.attr("display",null):o.attr("display","none"),f=d>=a,h=d3.select("path")[0][0].attributes.d.value+"Z",p.attr("d",h),m=n.node(),u=m.getTotalLength(),w=m.getPointAtLength(t-1),v=t;u>=v;v++)z=m.getPointAtLength(v),A={x:Math.round(100*z.x)/100,y:Math.round(100*z.y)/100},x=m.getPointAtLength(v-1),y={x:Math.round(100*x.x)/100,y:Math.round(100*x.y)/100},c[0].filter(G).forEach(D);if(f===!0&&e===!0){for(o.attr("d",g),i=o.node(),k=i.getTotalLength(),l={left:0,right:0},v=0;k>=v;v++)z=i.getPointAtLength(v),x=i.getPointAtLength(v-1),c[0].filter(F).forEach(E);c[0].forEach(function(a){a.lassoPoint.edges.left+a.lassoPoint.close_edges.left>0&&(a.lassoPoint.edges.right+a.lassoPoint.close_edges.right)%2===1?a.loopSelected=!0:a.loopSelected=!1})}else c[0].forEach(function(a){a.loopSelected=!1});d3.selectAll(c[0].filter(function(a){return a.loopSelected&&f||a.hoverSelected})).attr("d",function(a){return a.possible=!0,a.possible}),d3.selectAll(c[0].filter(function(a){return!(a.loopSelected&&f||a.hoverSelected)})).attr("d",function(a){return a.possible=!1,a.possible}),j.draw(),t=u+1}function l(){c.on("mouseover.lasso",null),c.filter(function(a){return a.possible===!0}).attr("d",function(a){return a.selected=!0,a.selected}),c.filter(function(a){return a.possible===!1}).attr("d",function(a){return a.selected=!1,a.selected}),c.attr("d",function(a){return a.possible=!1,a.possible}),n.attr("d",null),o.attr("d",null),j.end()}var m,n,o,p,q,r,s,t,u,v=d3.select(this[0][0]);i=i||v,0===i.selectAll("g.lasso").size()?(m=i.append("g").attr("class","lasso"),n=m.append("path").attr("class","drawn"),o=m.append("path").attr("class","loop_close"),p=m.append("path").attr("class","complete_path").attr("display","none")):(m=i.select("g.lasso"),n=m.select("path.drawn"),o=m.select("path.loop_close"),p=m.select("path.complete_path")),u=d3.behavior.drag().on("dragstart",a).on("drag",k).on("dragend",l),h.call(u)}function b(a){return a?0>a?-1:1:0}var c=null,d=75,e=!0,f=!1,g=!0,h=null,i=null,j={start:function(){},draw:function(){},end:function(){}};return a.items=function(b){return arguments.length?(c=b,c[0].forEach(function(a){var b=d3.select(a);"undefined"==typeof b.datum()?b.datum({possible:!1,selected:!1}):b.attr("d",function(a){return a.possible=!1,a.selected=!1,a})}),a):c},a.closePathDistance=function(b){return arguments.length?(d=b,a):d},a.closePathSelect=function(b){return arguments.length?(e=b===!0,a):e},a.isPathClosed=function(b){return arguments.length?(f=b===!0,a):f},a.hoverSelect=function(b){return arguments.length?(g=b===!0,a):g},a.on=function(b,c){if(!arguments.length)return j;if(1===arguments.length)return j[b];var d=["start","draw","end"];return d.indexOf(b)>-1&&(j[b]=c),a},a.area=function(b){return arguments.length?(h=b,a):h},a.pathContainer=function(b){return arguments.length?(i=d3.select(b[0][0]),a):i},a},f.main.init(),e.start=function(a){var b;return a?e.render(a):f.status.apexPluginId?(f.conf.showLoadingIndicatorOnAjaxCall&&e.showLoadingIndicator(!0),apex.server.plugin(f.status.apexPluginId,{p_debug:$v("pdebug"),pageItems:f.status.apexPageItemsToSubmit.split(",")},{success:function(a){f.conf.showLoadingIndicatorOnAjaxCall&&e.showLoadingIndicator(!1),b=a.trim().substr(0,1),"<"===b||"{"===b?e.render(a):"no_query_defined"===a.trim().substr(0,16)?(e.render(),f.tools.logError("No query defined.")):"query_returned_no_data"===a.trim().substr(0,22)?(e.render({data:{nodes:[{ID:"1",LABEL:"ERROR: No data.",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}),f.tools.logError("Query returned no data.")):(e.render({data:{nodes:[{ID:"1",LABEL:"ERROR: "+a+".",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}),f.tools.logError(a))},error:function(a,b,c){e.render({data:{nodes:[{ID:"1",LABEL:"AJAX call terminated with errors.",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}),f.tools.logError("AJAX call terminated with errors: "+c+".")},dataType:"text"})):e.render(),e},e.render=function(a){var b;if(f.status.graphStarted=!0,f.status.graphRendering=!0,f.tools.triggerApexEvent(document.querySelector("#"+f.dom.containerId),"apexbeforerefresh"),a||f.status.graphReady?a&&(f.status.sampleData=!1):(f.tools.logError("Houston, we have a problem - we have to provide sample data."),f.status.sampleData=!0,a=f.data.sampleData),a){if(f.status.graphReady&&(f.status.graphOldPositions=e.positions()),a.constructor===Object)f.data.dataConverted=a,f.conf.debug&&(f.tools.log("Data object:"),f.tools.log(f.data.dataConverted,!0));else if(a.constructor===String){if("<"===a.trim().substr(0,1))try{f.data.dataConverted=f.tools.xmlToJson(f.tools.parseXml(a)),null===f.data.dataConverted&&(b="Unable to convert XML string.",f.tools.logError(b),f.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}})}catch(c){b="Unable to convert XML string: "+c.message+".",f.tools.logError(b),f.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}}else if("{"===a.trim().substr(0,1))try{f.data.dataConverted=JSON.parse(a)}catch(c){b="Unable to parse JSON string: "+c.message+".",f.tools.logError(b),f.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}}else b='Your data string is not starting with "<" or "{" - parsing not possible.',f.tools.logError(b),f.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}};f.conf.debug&&(f.tools.log("Data string:"),f.tools.log(a,!0),f.tools.log("Converted data object:"),f.tools.log(f.data.dataConverted,!0))}else b="Unable to parse your data - input data can be a XML string, JSON string or JavaScript object.",f.tools.logError(b),f.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}};null!==f.data.dataConverted?f.data.dataConverted.hasOwnProperty("data")&&null!==f.data.dataConverted.data?(f.data.dataConverted.data.hasOwnProperty("nodes")&&null!==f.data.dataConverted.data.nodes?(f.data.nodes=f.data.dataConverted.data.nodes,0===f.data.nodes.length&&(b="Your data contains an empty nodes array.",f.tools.logError(b),f.data.nodes=[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}])):(b="Your data contains no nodes.",f.tools.logError(b),f.data.nodes=[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}]),f.data.dataConverted.data.hasOwnProperty("links")&&null!==f.data.dataConverted.data.links?f.data.links=f.data.dataConverted.data.links:f.data.links=[]):(b="Missing root element named data.",f.tools.logError(b),f.data={nodes:[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}):(b="Unable to parse your data - please consult the API reference for possible data formats.",f.tools.logError(b),f.data={nodes:[{ID:"1",LABEL:"ERROR: "+b,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}),f.data.idLookup=[],f.data.nodes.forEach(function(a){a.SIZEVALUE=parseFloat(a.SIZEVALUE),a.LABELCIRCULAR=f.tools.parseBool(a.LABELCIRCULAR),a.fixed&&(a.fixed=f.tools.parseBool(a.fixed)),a.x&&(a.x=parseFloat(a.x)),a.y&&(a.y=parseFloat(a.y)),f.data.idLookup[a.ID]=a}),f.data.links.forEach(function(a){a.source=f.data.idLookup[a.FROMID],a.target=f.data.idLookup[a.TOID]}),f.data.links=f.data.links.filter(function(a){return"undefined"!=typeof a.source&&"undefined"!=typeof a.target}),f.data.neighbors=f.data.links.map(function(a){return a.FROMID+":"+a.TOID}),f.data.distinctNodeColorValues=f.data.nodes.map(function(a){return(a.COLORLABEL?a.COLORLABEL:"")+";"+a.COLORVALUE}).filter(function(a,b,c){return c.indexOf(a)===b}).sort(function(a,b){var c=a.toLowerCase(),d=b.toLowerCase();return d>c?1:c>d?-1:0}),f.data.distinctLinkColorValues=f.data.links.map(function(a){return a.COLOR}).filter(Boolean).filter(function(a,b,c){return c.indexOf(a)===b}).sort(function(a,b){var c=a.toLowerCase(),d=b.toLowerCase();return d>c?1:c>d?-1:0}),f.conf.positions?f.conf.positions.constructor===Array?f.conf.positions.forEach(function(a){void 0!==f.data.idLookup[a.ID]&&(f.data.idLookup[a.ID].fixed||(f.data.idLookup[a.ID].fixed=a.fixed),f.data.idLookup[a.ID].x||(f.data.idLookup[a.ID].x=f.data.idLookup[a.ID].px=a.x),f.data.idLookup[a.ID].y||(f.data.idLookup[a.ID].y=f.data.idLookup[a.ID].py=a.y))}):f.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):f.status.graphOldPositions&&f.status.graphOldPositions.forEach(function(a){void 0!==f.data.idLookup[a.ID]&&(f.data.idLookup[a.ID].fixed||(f.data.idLookup[a.ID].fixed=a.fixed),f.data.idLookup[a.ID].x||(f.data.idLookup[a.ID].x=f.data.idLookup[a.ID].px=a.x),f.data.idLookup[a.ID].y||(f.data.idLookup[a.ID].y=f.data.idLookup[a.ID].py=a.y))}),f.conf.positions=null,f.status.graphOldPositions=null}return f.tools.setColorFunction(),f.tools.setRadiusFunction(),f.data.nodes.forEach(function(a){a.radius=f.tools.radius(a.SIZEVALUE)}),f.main.markers=f.dom.defs.selectAll("marker.custom").data(f.data.distinctLinkColorValues,function(a){return a}),f.main.markers.enter().append("svg:marker").attr("id",function(a){return f.dom.containerId+"_"+a}).attr("class","custom").attr("stroke","none").attr("fill",function(a){return a}).attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),f.main.markers.exit().remove(),f.main.links=f.dom.graph.selectAll("line.link").data(f.data.links.filter(function(a){return a.FROMID!==a.TOID}),function(a){return a.FROMID+"_"+a.TOID}),f.main.links.enter().append("svg:line").attr("class","link").on("mouseenter",f.tools.onLinkMouseenter).on("mouseleave",f.tools.onLinkMouseleave).on("click",f.tools.onLinkClick),f.main.links.exit().remove(),f.main.links.style("marker-end",f.tools.getMarkerUrl).classed("dotted",function(a){return"dotted"===a.STYLE}).classed("dashed",function(a){return"dashed"===a.STYLE}).style("stroke",function(a){return a.COLOR?a.COLOR:null}),f.main.selfLinks=f.dom.graph.selectAll("path.link").data(f.data.links.filter(function(a){return a.FROMID===a.TOID&&f.conf.showSelfLinks}),function(a){return a.FROMID+"_"+a.TOID}),f.main.selfLinks.enter().append("svg:path").attr("id",function(a){return f.dom.containerId+"_link_"+a.FROMID+"_"+a.TOID}).attr("class","link").on("mouseenter",f.tools.onLinkMouseenter).on("mouseleave",f.tools.onLinkMouseleave).on("click",f.tools.onLinkClick),f.main.selfLinks.exit().remove(),f.main.selfLinks.attr("d",function(a){return f.tools.getSelfLinkPath(a)}).style("marker-end",f.tools.getMarkerUrl).classed("dotted",function(a){return"dotted"===a.STYLE}).classed("dashed",function(a){return"dashed"===a.STYLE}).style("stroke",function(a){return a.COLOR?a.COLOR:null}),f.main.patterns=f.dom.defs.selectAll("pattern").data(f.data.nodes.filter(function(a){return a.IMAGE?!0:!1}),function(a){return a.ID}),f.main.patterns.enter().append("svg:pattern").attr("id",function(a){return f.dom.containerId+"_pattern_"+a.ID}).append("svg:image"),f.main.patterns.exit().remove(),f.main.patterns.each(function(){d3.select(this).attr("x",0).attr("y",0).attr("height",function(a){return 2*a.radius}).attr("width",function(a){return 2*a.radius}),d3.select(this.firstChild).attr("x",0).attr("y",0).attr("height",function(a){return 2*a.radius}).attr("width",function(a){return 2*a.radius}).attr("xlink:href",function(a){return a.IMAGE})}),f.main.nodes=f.dom.graph.selectAll("circle.node").data(f.data.nodes,function(a){return a.ID}),f.main.nodes.enter().append("svg:circle").attr("class","node").attr("cx",function(a){return a.fixed||a.x?void 0:(a.x=Math.floor(Math.random()*f.tools.getGraphWidth()+1),a.x)}).attr("cy",function(a){return a.fixed||a.y?void 0:(a.y=Math.floor(Math.random()*f.conf.height+1),a.y)}).on("mouseenter",f.tools.onNodeMouseenter).on("mouseleave",f.tools.onNodeMouseleave).on("click",f.tools.onNodeClick).on("dblclick",f.tools.onNodeDblclick).on("contextmenu",f.tools.onNodeContextmenu),f.main.nodes.exit().remove(),f.main.nodes.attr("r",function(a){return a.radius}).attr("fill",function(a){return a.IMAGE?"url(#"+f.dom.containerId+"_pattern_"+a.ID+")":f.tools.color(a.COLORVALUE)}),f.conf.showLabels?(f.main.labels=f.dom.graph.selectAll("text.label").data(f.data.nodes.filter(function(a){return!a.LABELCIRCULAR&&!f.conf.labelsCircular}),function(a){return a.ID}),f.main.labels.enter().append("svg:text").attr("class","label"),f.main.labels.exit().remove(),f.main.labels.text(function(a){return a.LABEL}),f.main.labelPaths=f.dom.defs.selectAll("path.label").data(f.data.nodes.filter(function(a){return a.LABELCIRCULAR||f.conf.labelsCircular}),function(a){return a.ID}),f.main.labelPaths.enter().append("svg:path").attr("id",function(a){return f.dom.containerId+"_textPath_"+a.ID}).attr("class","label"),f.main.labelPaths.exit().remove(),f.main.labelPaths.attr("d",function(a){return f.tools.getLabelPath(a)}),f.main.labelsCircular=f.dom.graph.selectAll("text.labelCircular").data(f.data.nodes.filter(function(a){return a.LABELCIRCULAR||f.conf.labelsCircular}),function(a){return a.ID}),f.main.labelsCircular.enter().append("svg:text").attr("class","labelCircular").append("svg:textPath").attr("xlink:href",function(a){return"#"+f.dom.containerId+"_textPath_"+a.ID}),f.main.labelsCircular.exit().remove(),f.main.labelsCircular.each(function(a){d3.select(this.firstChild).text(a.LABEL)})):(f.dom.defs.selectAll("path.label").remove(),f.dom.graph.selectAll("text.label,text.labelCircular").remove()),e.debug(f.conf.debug).showBorder(f.conf.showBorder).setDomParentPaddingToZero(f.conf.setDomParentPaddingToZero).useDomParentWidth(f.conf.useDomParentWidth).width(f.conf.width).height(f.conf.height).alignFixedNodesToGrid(f.conf.alignFixedNodesToGrid).dragMode(f.conf.dragMode).pinMode(f.conf.pinMode).lassoMode(f.conf.lassoMode).zoomMode(f.conf.zoomMode).transform(f.conf.transform).autoRefresh(f.conf.autoRefresh).linkDistance(f.conf.linkDistance).charge(f.conf.charge).chargeDistance(f.conf.chargeDistance).gravity(f.conf.gravity).linkStrength(f.conf.linkStrength).friction(f.conf.friction).theta(f.conf.theta),f.main.force.nodes(f.data.nodes).links(f.data.links).start(),f.status.customize?f.tools.createCustomizeWizard():f.tools.createCustomizeLink(),f.status.graphReady=!0,f.status.graphRendering=!1,f.tools.triggerApexEvent(document.querySelector("#"+f.dom.containerId),"apexafterrefresh"),e},e.resume=function(){return f.main.force.resume(),f.tools.createCustomizeWizardIfNotRendering(),e},e.showBorder=function(a){return arguments.length?(f.conf.showBorder=a,f.status.graphStarted&&(f.dom.svg.classed("border",f.conf.showBorder),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.showBorder},e.showLegend=function(a){return arguments.length?(f.conf.showLegend=a,f.status.graphStarted&&(f.conf.showLegend?(f.tools.removeLegend(),f.tools.createLegend()):f.tools.removeLegend(),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.showLegend},e.showSelfLinks=function(a){return arguments.length?(f.conf.showSelfLinks=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.showSelfLinks},e.showLinkDirection=function(a){return arguments.length?(f.conf.showLinkDirection=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.showLinkDirection},e.showTooltips=function(a){return arguments.length?(f.conf.showTooltips=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.showTooltips},e.tooltipPosition=function(a){return arguments.length?(f.conf.tooltipPosition=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.tooltipPosition},e.colorScheme=function(a){return arguments.length?(f.conf.colorScheme=a,f.tools.setColorFunction(),f.status.graphStarted&&(f.main.nodes.attr("fill",function(a){return a.IMAGE?"url(#"+f.dom.containerId+"_pattern_"+a.ID+")":f.tools.color(a.COLORVALUE)}),f.conf.showLegend&&(f.tools.removeLegend(),f.tools.createLegend()),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.colorScheme},e.showLabels=function(a){return arguments.length?(f.conf.showLabels=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.showLabels},e.labelsCircular=function(a){return arguments.length?(f.conf.labelsCircular=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.labelsCircular},e.preventLabelOverlappingOnForceEnd=function(a){return arguments.length?(f.conf.preventLabelOverlappingOnForceEnd=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.preventLabelOverlappingOnForceEnd},e.labelPlacementIterations=function(a){return arguments.length?(f.conf.labelPlacementIterations=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.labelPlacementIterations},e.dragMode=function(a){return arguments.length?(f.conf.dragMode=a,f.status.graphStarted&&(f.conf.dragMode?f.main.nodes.call(f.main.drag):(f.main.nodes.on("mousedown.drag",null),f.main.nodes.on("touchstart.drag",null)),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.dragMode},e.pinMode=function(a){return arguments.length?(f.conf.pinMode=a,f.status.graphStarted&&(f.conf.pinMode?f.main.drag.on("dragstart",function(a){d3.select(this).classed("fixed",a.fixed=1)}):f.main.drag.on("dragstart",null),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.pinMode},e.lassoMode=function(a){return arguments.length?(f.conf.lassoMode=a,f.status.graphStarted&&(f.conf.lassoMode?(f.dom.graphOverlay.call(f.main.lasso),f.main.lasso.items(f.main.nodes),f.main.lasso.on("start",function(){f.main.lasso.items().classed("selected",!1),f.tools.onLassoStart(f.main.lasso.items())}),f.main.lasso.on("draw",function(){f.main.lasso.items().filter(function(a){return a.possible===!0}).classed("selected",!0),f.main.lasso.items().filter(function(a){return a.possible===!1}).classed("selected",!1)}),f.main.lasso.on("end",function(){f.main.lasso.items().filter(function(a){return a.selected===!0}).classed("selected",!0),f.main.lasso.items().filter(function(a){return a.selected===!1}).classed("selected",!1),f.tools.onLassoEnd(f.main.lasso.items())}),f.events.mousedownLasso=f.dom.graphOverlay.on("mousedown.drag"),f.events.touchstartLasso=f.dom.graphOverlay.on("touchstart.drag"),f.dom.graphOverlay.on("mousedown.drag",f.tools.lassoEventProxy(f.events.mousedownLasso)),f.dom.graphOverlay.on("touchstart.drag",f.tools.lassoEventProxy(f.events.touchstartLasso))):(f.dom.graphOverlay.on(".drag",null),f.main.nodes.classed("selected",!1)),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.lassoMode},e.transform=function(a){return arguments.length?(f.main.zoom.translate(a.translate),f.main.zoom.scale(a.scale),f.conf.transform={translate:f.main.zoom.translate(),scale:f.main.zoom.scale()},f.conf.zoomMode&&f.status.graphStarted&&(f.dom.graph.attr("transform","translate("+f.main.zoom.translate()+")scale("+f.main.zoom.scale()+")"),f.tools.writeConfObjectIntoWizard()),e):{translate:f.main.zoom.translate(),scale:f.main.zoom.scale()}},e.zoomMode=function(a){return arguments.length?(f.conf.zoomMode=a,f.status.graphStarted&&(f.conf.zoomMode?(f.dom.graphOverlay.call(f.main.zoom),f.main.zoom.scaleExtent([f.conf.minZoomFactor,f.conf.maxZoomFactor]).size([f.tools.getGraphWidth(),f.conf.height]).on("zoom",function(){f.main.zoom.translate(d3.event.translate),
f.main.zoom.scale(d3.event.scale),f.conf.transform={translate:f.main.zoom.translate(),scale:f.main.zoom.scale()},f.dom.graph.attr("transform","translate("+f.main.zoom.translate()+")scale("+f.main.zoom.scale()+")"),f.tools.writeConfObjectIntoWizard()}),f.events.dblclickZoom=f.dom.graphOverlay.on("dblclick.zoom"),f.events.mousedownZoom=f.dom.graphOverlay.on("mousedown.zoom"),f.events.touchstartZoom=f.dom.graphOverlay.on("touchstart.zoom"),f.dom.graphOverlay.on("dblclick.zoom",f.tools.zoomEventProxy(f.events.dblclickZoom)),f.dom.graphOverlay.on("mousedown.zoom",f.tools.zoomEventProxy(f.events.mousedownZoom)),f.dom.graphOverlay.on("touchstart.zoom",f.tools.zoomEventProxy(f.events.touchstartZoom)),JSON.stringify(f.conf.transform)!==JSON.stringify(f.confDefaults.transform)&&(f.dom.graph.attr("transform","translate("+f.main.zoom.translate()+")scale("+f.main.zoom.scale()+")"),f.tools.writeConfObjectIntoWizard())):(f.dom.graphOverlay.on(".zoom",null),f.main.zoom.translate([0,0]),f.main.zoom.scale(1),f.conf.transform={translate:[0,0],scale:1},f.dom.graph.attr("transform","translate(0,0)scale(1)")),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.zoomMode},e.minZoomFactor=function(a){return arguments.length?(f.conf.minZoomFactor=a,f.status.graphReady&&e.zoomMode(f.conf.zoomMode),e):f.conf.minZoomFactor},e.maxZoomFactor=function(a){return arguments.length?(f.conf.maxZoomFactor=a,f.status.graphReady&&e.zoomMode(f.conf.zoomMode),e):f.conf.maxZoomFactor},e.zoom=function(a,b,c){if(f.conf.zoomMode){var d=f.tools.getGraphWidth();a||(a=d/2),b||(b=f.conf.height/2),c||(c=d),f.main.zoom.scale(d/c),f.main.zoom.scale()<f.conf.minZoomFactor&&f.main.zoom.scale(f.conf.minZoomFactor),f.main.zoom.scale()>f.conf.maxZoomFactor&&f.main.zoom.scale(f.conf.maxZoomFactor),f.main.zoom.translate([d/2-a*f.main.zoom.scale(),f.conf.height/2-b*f.main.zoom.scale()]),f.conf.transform={translate:f.main.zoom.translate(),scale:f.main.zoom.scale()},f.main.zoom.event(f.dom.graphOverlay),f.tools.writeConfObjectIntoWizard()}return e},e.zoomSmooth=function(a,b,c,d){if(f.conf.zoomMode){var g=f.tools.getGraphWidth();a||(a=g/2),b||(b=f.conf.height/2),c||(c=g),d||(d=1500),f.main.zoom.scale(g/c),f.main.zoom.scale()<f.conf.minZoomFactor&&f.main.zoom.scale(f.conf.minZoomFactor),f.main.zoom.scale()>f.conf.maxZoomFactor&&f.main.zoom.scale(f.conf.maxZoomFactor),f.main.zoom.translate([g/2-a*f.main.zoom.scale(),f.conf.height/2-b*f.main.zoom.scale()]),f.conf.translate={translate:f.main.zoom.translate(),scale:f.main.zoom.scale()},f.dom.graphOverlay.transition().duration(d).call(f.main.zoom.event),f.tools.writeConfObjectIntoWizard()}return e},e.showLoadingIndicatorOnAjaxCall=function(a){return arguments.length?(f.conf.showLoadingIndicatorOnAjaxCall=a,e):f.conf.showLoadingIndicatorOnAjaxCall},e.showLoadingIndicator=function(a){return f.tools.parseBool(a)?f.dom.loading.style("display","block"):f.dom.loading.style("display","none"),e},e.alignFixedNodesToGrid=function(a){return arguments.length?(f.conf.alignFixedNodesToGrid=a,f.status.graphStarted&&(f.conf.alignFixedNodesToGrid?(f.status.graphReady&&f.main.nodes.each(function(a){a.fixed&&(a.x=a.px=f.tools.getNearestGridPosition(a.x,f.conf.width),a.y=a.py=f.tools.getNearestGridPosition(a.y,f.conf.height))}),f.main.drag.on("dragend",function(a){a.x=a.px=f.tools.getNearestGridPosition(a.x,f.conf.width),a.y=a.py=f.tools.getNearestGridPosition(a.y,f.conf.height)})):f.main.drag.on("dragend",null),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.alignFixedNodesToGrid},e.moveFixedNodes=function(a,b){return f.status.graphStarted&&(a||(a=0),b||(b=0),(0!==a||0!==b)&&f.main.nodes.each(function(c){c.fixed&&(c.x=c.px=f.conf.alignFixedNodesToGrid?f.tools.getNearestGridPosition(c.x+a,f.conf.width):c.x+a,c.y=c.py=f.conf.alignFixedNodesToGrid?f.tools.getNearestGridPosition(c.y+b,f.conf.width):c.y+b)})),e},e.gridSize=function(a){return arguments.length?(f.conf.gridSize=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.gridSize},e.nodeEventToStopPinMode=function(a){return arguments.length?(f.conf.nodeEventToStopPinMode=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.nodeEventToStopPinMode},e.onNodeContextmenuPreventDefault=function(a){return arguments.length?(f.conf.onNodeContextmenuPreventDefault=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.onNodeContextmenuPreventDefault},e.nodeEventToOpenLink=function(a){return arguments.length?(f.conf.nodeEventToOpenLink=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.nodeEventToOpenLink},e.nodeLinkTarget=function(a){return arguments.length?(f.conf.nodeLinkTarget=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.nodeLinkTarget},e.autoRefresh=function(a){return arguments.length?(f.conf.autoRefresh=a,f.status.graphStarted&&(f.conf.autoRefresh&&f.conf.refreshInterval&&!f.conf.interval?(f.conf.interval=window.setInterval(function(){e.start()},f.conf.refreshInterval),f.tools.log("Auto refresh started with an interval of "+f.conf.refreshInterval+" milliseconds.")):!f.conf.autoRefresh&&f.conf.interval&&(clearInterval(f.conf.interval),f.conf.interval=null,f.tools.log("Auto refresh stopped.")),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.autoRefresh},e.refreshInterval=function(a){return arguments.length?(f.conf.refreshInterval=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.refreshInterval},e.useDomParentWidth=function(a){return arguments.length?(f.conf.useDomParentWidth=a,f.status.graphStarted&&(f.conf.useDomParentWidth?(f.dom.containerWidth=f.tools.getSvgParentInnerWidth(),d3.select(window).on("resize",function(){var a=f.dom.containerWidth,b=f.tools.getSvgParentInnerWidth();a!==b&&(f.dom.containerWidth=b,e.width(f.conf.width).resume())})):d3.select(window).on("resize",null),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.useDomParentWidth},e.setDomParentPaddingToZero=function(a){return arguments.length?(f.conf.setDomParentPaddingToZero=a,f.status.graphStarted&&(f.conf.setDomParentPaddingToZero?f.dom.svgParent.style("padding","0"):f.dom.svgParent.style("padding",null),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.setDomParentPaddingToZero},e.domParentWidth=function(){return f.dom.containerWidth||f.tools.getSvgParentInnerWidth()},e.width=function(a){return arguments.length?(f.conf.width=a,f.status.graphStarted&&(f.dom.svg.attr("width",f.tools.getGraphWidth()),f.dom.graphOverlaySizeHelper.attr("width",f.tools.getGraphWidth()),f.dom.loadingRect.attr("width",f.tools.getGraphWidth()),f.dom.loadingText.attr("x",f.tools.getGraphWidth()/2),f.main.force.size([f.tools.getGraphWidth(),f.conf.height]),f.conf.zoomMode&&f.main.zoom.size([f.tools.getGraphWidth(),f.conf.height]),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.width},e.height=function(a){return arguments.length?(f.conf.height=a,f.status.graphStarted&&(f.dom.svg.attr("height",f.conf.height),f.dom.graphOverlaySizeHelper.attr("height",f.conf.height),f.dom.loadingRect.attr("height",f.conf.height),f.dom.loadingText.attr("y",f.conf.height/2),f.main.force.size([f.tools.getGraphWidth(),f.conf.height]),f.conf.showLegend&&(f.tools.removeLegend(),f.tools.createLegend()),f.conf.zoomMode&&f.main.zoom.size([f.tools.getGraphWidth(),f.conf.height]),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.height},e.minNodeRadius=function(a){return arguments.length?(f.conf.minNodeRadius=a,f.status.graphReady&&(f.tools.setRadiusFunction(),f.main.nodes.each(function(a){a.radius=f.tools.radius(a.SIZEVALUE)}),f.main.nodes.attr("r",function(a){return a.radius}),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.minNodeRadius},e.maxNodeRadius=function(a){return arguments.length?(f.conf.maxNodeRadius=a,f.status.graphReady&&(f.tools.setRadiusFunction(),f.main.nodes.each(function(a){a.radius=f.tools.radius(a.SIZEVALUE)}),f.main.nodes.attr("r",function(a){return a.radius}),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.maxNodeRadius},e.labelDistance=function(a){return arguments.length?(f.conf.labelDistance=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.labelDistance},e.selfLinkDistance=function(a){return arguments.length?(f.conf.selfLinkDistance=a,f.status.graphStarted&&f.tools.createCustomizeWizardIfNotRendering(),e):f.conf.selfLinkDistance},e.linkDistance=function(a){return arguments.length?(f.conf.linkDistance=a,f.status.graphStarted&&(f.main.force.linkDistance(f.conf.linkDistance),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.linkDistance},e.charge=function(a){return arguments.length?(f.conf.charge=a,f.status.graphStarted&&(f.main.force.charge(f.conf.charge),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.charge},e.chargeDistance=function(a){return arguments.length?(f.conf.chargeDistance=a,f.status.graphStarted&&(f.main.force.chargeDistance(f.conf.chargeDistance),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.chargeDistance},e.gravity=function(a){return arguments.length?(f.conf.gravity=a,f.status.graphStarted&&(f.main.force.gravity(f.conf.gravity),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.gravity},e.linkStrength=function(a){return arguments.length?(f.conf.linkStrength=a,f.status.graphStarted&&(f.main.force.linkStrength(f.conf.linkStrength),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.linkStrength},e.friction=function(a){return arguments.length?(f.conf.friction=a,f.status.graphStarted&&(f.main.force.friction(f.conf.friction),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.friction},e.theta=function(a){return arguments.length?(f.conf.theta=a,f.status.graphStarted&&(f.main.force.theta(f.conf.theta),f.tools.createCustomizeWizardIfNotRendering()),e):f.conf.theta},e.positions=function(a){if(arguments.length)return f.status.graphReady?a.constructor===Array?a.forEach(function(a){void 0!==f.data.idLookup[a.ID]&&(f.data.idLookup[a.ID].fixed=f.tools.parseBool(a.fixed),f.data.idLookup[a.ID].x=f.data.idLookup[a.ID].px=a.x,f.data.idLookup[a.ID].y=f.data.idLookup[a.ID].py=a.y)}):f.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):f.conf.positions=a,e;var b=[];return f.data.nodes.forEach(function(a){b.push({ID:a.ID,x:Math.round(a.x),y:Math.round(a.y),fixed:a.fixed?1:0})}),b},e.onLinkClickFunction=function(a){return arguments.length?(f.conf.onLinkClickFunction=a,e):f.conf.onLinkClickFunction},e.onNodeMouseenterFunction=function(a){return arguments.length?(f.conf.onNodeMouseenterFunction=a,e):f.conf.onNodeMouseenterFunction},e.onNodeMouseleaveFunction=function(a){return arguments.length?(f.conf.onNodeMouseleaveFunction=a,e):f.conf.onNodeMouseleaveFunction},e.onNodeClickFunction=function(a){return arguments.length?(f.conf.onNodeClickFunction=a,e):f.conf.onNodeClickFunction},e.onNodeDblclickFunction=function(a){return arguments.length?(f.conf.onNodeDblclickFunction=a,e):f.conf.onNodeDblclickFunction},e.onNodeContextmenuFunction=function(a){return arguments.length?(f.conf.onNodeContextmenuFunction=a,e):f.conf.onNodeContextmenuFunction},e.onLassoStartFunction=function(a){return arguments.length?(f.conf.onLassoStartFunction=a,e):f.conf.onLassoStartFunction},e.onLassoEndFunction=function(a){return arguments.length?(f.conf.onLassoEndFunction=a,e):f.conf.onLassoEndFunction},e.sampleData=function(a){return arguments.length?(f.data.sampleData=a,e):f.data.sampleData},e.data=function(){return f.data.dataConverted},e.nodeDataById=function(a){return f.data.idLookup[a]},e.options=function(a){var b;if(arguments.length)return f.tools.applyConfigurationObject(a),e;var c={};for(b in f.conf)f.conf.hasOwnProperty(b)&&(f.confDefaults.hasOwnProperty(b)?"bool"!==f.confDefaults[b].type&&"number"!==f.confDefaults[b].type&&"text"!==f.confDefaults[b].type||f.confDefaults[b].val===f.conf[b]?"object"===f.confDefaults[b].type&&JSON.stringify(f.confDefaults[b].val)!==JSON.stringify(f.conf[b])&&(c[b]=f.conf[b]):c[b]=f.conf[b]:f.confDefaults.hasOwnProperty(b)||void 0===f.conf[b]||null===f.conf[b]||(c[b]=f.conf[b]));return c},e.optionsCustomizationWizard=function(a){var b;if(arguments.length)return f.tools.applyConfigurationObject(a),e;var c={};for(b in f.confDefaults)f.confDefaults.hasOwnProperty(b)&&("bool"!==f.confDefaults[b].type&&"number"!==f.confDefaults[b].type&&"text"!==f.confDefaults[b].type||f.confDefaults[b].val===f.conf[b]?"object"===f.confDefaults[b].type&&JSON.stringify(f.confDefaults[b].val)!==JSON.stringify(f.conf[b])&&(c[b]=f.conf[b]):c[b]=f.conf[b]);return c},e.customize=function(a){return arguments.length?(f.status.customize=a,f.status.graphStarted&&(f.status.customize?f.tools.createCustomizeWizard():f.tools.removeCustomizeWizard()),e):f.status.customize},e.debug=function(a){return arguments.length?(f.conf.debug=a,f.status.graphStarted&&(f.conf.debug?f.tools.createCustomizeLink():f.tools.removeCustomizeLink()),e):f.conf.debug},e.releaseFixedNodes=function(){return f.status.graphStarted&&f.main.nodes.each(function(a){a.fixed=0}),e},e.userAgent=function(){return f.status.userAgent},e.inspect=function(){return f},e.version=function(){return f.version},f.status.apexPluginId&&apex.jQuery("#"+f.dom.containerId).bind("apexrefresh",function(){e.start()}),e}